"use strict";customElements.define("my-calculator",class extends HTMLElement{static get observedAttributes(){return["calc-name","calc-input","width","height","margin","border-radius",]}constructor(){super();let e=this.attachShadow({mode:"open"}),t=document.createElement("template");t.innerHTML=`
          <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
          <style>
              .calc-container {
                  user-select: none;
                  display: inline-block;
                  -ms-overflow-style: none;
                  /* Hide scrollbar in IE, Edge */
                  scrollbar-width: none;
                  /* Hide scrollbar in Firefox */
                  width: 360px;
                  margin: 50px;
                  padding: 10px;
                  border-radius: 25px;
                  border: 15px ridge rgb(165, 165, 165);
                  background-image: linear-gradient(0deg, rgb(0, 0, 0), rgb(0, 7, 100));
                  box-shadow: 15px 15px 15px 0px rgba(54, 54, 54, 0.6);
              }
  
              /* Hide scrollbar in Chrome and Safari */
              ::-webkit-scrollbar {
                  display: none;
                  width: 0px;
              }
  
              .calc-heading {
                  margin-left: 0px;
                  margin-right: 0px;
                  margin-bottom: -15px;
                  margin-top: -25px;
                  border-radius: 15px;
                  background-image: linear-gradient(45deg, rgba(255, 37, 237, 0.5), rgba(255, 45, 108, 0.5));
  
              }
  
              .calc-heading>p {
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  text-align: center;
                  padding: 10px;
                  font-family: Georgia, 'Times New Roman', Times, serif;
                  font-size: 25px;
                  font-weight: bold;
                  color: rgb(214, 214, 214);
              }
  
              .calc-display {
                  color: rgb(235, 235, 235);
                  font-family: Verdana, Geneva, Tahoma, sans-serif;
                  height: 100px;
                  margin: 10px 0px;
                  padding: 1px;
                  border-radius: 15px;
                  background-color: rgb(75, 75, 75);
              }
  
              #output {
                  display: flex;
                  justify-content: flex-start;
              }
  
              #output > input {
                  display: inline-block;
                  overflow: scroll;
                  border: none;
                  outline: none;
                  line-height: 55px;
                  /* To set caret height */
                  caret-color: rgb(0, 174, 255);
                  margin: 0px 10px;
                  font-size: 32px;
                  font-family: Verdana, Geneva, Tahoma, sans-serif;
                  background-color: rgb(75, 75, 75);
                  color: rgb(235, 235, 235);
              }
  
              #error-msg {
                  margin: 0px 10px;
                  overflow: scroll;
                  color: rgb(255, 87, 21);
                  font-size: 21px;
              }
  
              .calc-keys {
                  display: flex;
                  flex-flow: row wrap;
                  justify-content: space-between;
                  align-items: flex-end;
                  padding: 0px;
                  margin: 10px;
              }
  
              .calc-key {
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  margin: 4px 4px;
                  width: 70px;
                  height: 55px;
                  font-size: 25px;
                  font-family: Verdana, Geneva, Tahoma, sans-serif;
                  border-radius: 50%;
              }
  
              .calc-key:hover {
                  cursor: pointer;
                  box-shadow: 4px 4px 15px rgba(173, 173, 173, 0.6);
              }
  
              .calc-key:active {
                  cursor: pointer;
                  border-radius: 15px;
              }
  
              #equal-key {
                  color: rgb(8, 8, 8);
                  background-color: rgb(200, 255, 252);
              }
  
              #equal-key:hover {
                  color: rgb(8, 8, 8);
                  background-color: rgb(228, 255, 254);
              }
  
              #reset-key {
                  color: rgb(8, 8, 8);
                  background-color: rgb(153, 226, 153);
              }
  
              #reset-key:hover {
                  color: rgb(8, 8, 8);
                  background-color: rgb(184, 255, 184);
              }
  
              #parenthesis-key {
                  font-family:monospace;
                  font-weight:bold;
              }

              #factorial-key {
                font-family: Georgia, 'Times New Roman', Times, serif;
                font-size: 35px;
              }
  
              .blue-keys {
                  color: rgb(8, 8, 8);
                  background-color: rgb(0, 174, 255);
              }
  
              .blue-keys:hover {
                  color: rgb(8, 8, 8);
                  background-color: rgb(124, 213, 255);
              }
  
              .orange-keys {
                  color: rgb(8, 8, 8);
                  background-color: rgb(196, 127, 0);
              }
  
              .orange-keys:hover {
                  color: rgb(8, 8, 8);
                  background-color: rgb(252, 164, 0);
              }
  
              .black-keys {
                  color: rgb(235, 235, 235);
                  background-color: rgb(61, 61, 61);
              }
  
              .black-keys:hover {
                  color: rgb(235, 235, 235);
                  background-color: rgb(90, 90, 90);
              }
  
              .black-keys:active {
                  color: rgb(235, 235, 235);
                  background-color: rgb(100, 100, 100);
              }
          </style>
  
          <!---------------------    My Calculator Container   --------------------->
          <div class="calc-container" tabindex="1">
  
              <!------------------    Heading   ------------------>
              <div class="calc-heading">
                  <p>My Calculator</p>
              </div>
  
              <!------------------    Display   ------------------>
              <div class="calc-display">
                  <div id="output">
                      <input type="text" inputmode="none" placeholder="Enter input..." tabindex="1.2">
                  </div>
                  <div id="error-msg"></div>
              </div>
  
              <!------------------    Keys   ------------------>
              <div class="calc-keys">
                  <!------------------------    Row 1   ------------------------>
                  <div id="reset-key" class="calc-key" title="All Clear (Reset)" tabindex="2">AC</div>
                  <div class="calc-key orange-keys" id="inverse-key" title="Inverse (Reciprocal)" tabindex="3">
                      <img id="img-inverse-key" src="./resources/images/x-inverse.png" alt="x-inverse-key" width="35" height="35">
                  </div>
                  <div class="calc-key orange-keys" id="squared-key" title="Squared" tabindex="4">
                      <img id="img-squared-key" src="./resources/images/x-square.png" alt="x-squared-key" width="25" height="25">
                  </div>
                  <div class="calc-key orange-keys" id="sqrt-key" title="Square Root" tabindex="5">
                    <img id="img-sqrt-key" src="./resources/images/sqrt.png" alt="sqrt-key" width="40" height="40">
                  </div>
  
                  <!------------------------    Row 2   ------------------------>
                  <div class="calc-key blue-keys" id="parenthesis-key" title="Parenthesis" tabindex="6">
                      ()
                  </div>
                  <div class="calc-key blue-keys" id="factorial-key" title="Factorial ( a! )" tabindex="7">
                      !
                  </div>
                  <div class="calc-key blue-keys" id="exponent-key" title="Exponent (x ^ y)" tabindex="8">
                      <img id="img-exponent-key" src="./resources/images/x-power-y.png" alt="exponent-key" width="30" height="30">
                  </div>
                  <div class="calc-key blue-keys" style="font-size:42px;font-family:monospace" id="divide-key" title="Divide (a / b)" tabindex="9">
                    &divide;
                  </div>
  
                  <!------------------------    Row 3   ------------------------>
                  <div class="calc-key black-keys" id="key-7" tabindex="22">7</div>
                  <div class="calc-key black-keys" id="key-8" tabindex="23">8</div>
                  <div class="calc-key black-keys" id="key-9" tabindex="24">9</div>
                  <div class="calc-key blue-keys" id="multiply-key" title="Multiply (a x b)" tabindex="10">
                      <i id="img-multiply-key" class="material-icons" style="font-size:32px;">close</i>
                  </div>
  
                  <!------------------------    Row 4   ------------------------>
                  <div class="calc-key black-keys" id="key-4" tabindex="19">4</div>
                  <div class="calc-key black-keys" id="key-5" tabindex="20">5</div>
                  <div class="calc-key black-keys" id="key-6" tabindex="21">6</div>
                  <div class="calc-key blue-keys" id="subtract-key" title="Subtract (a - b)" tabindex="11">
                      <i id="img-subtract-key" class="material-icons" style="font-size:35px;">remove</i>
                  </div>
  
                  <!------------------------    Row 5   ------------------------>
                  <div class="calc-key black-keys" id="key-1" tabindex="16">1</div>
                  <div class="calc-key black-keys" id="key-2" tabindex="17">2</div>
                  <div class="calc-key black-keys" id="key-3" tabindex="18">3</div>
                  <div class="calc-key blue-keys" id="add-key" title="Add (a + b)" tabindex="12">
                      <i id="img-add-key" class="material-icons" style="font-size:35px;">add</i>
                  </div>
  
                  <!------------------------    Row 6   ------------------------>
                  <div class="calc-key black-keys" id="decimal-point-key" title="Decimal point" tabindex="25">.</div>
                  <div class="calc-key black-keys" id="key-0" tabindex="15">0</div>
                  <div class="calc-key black-keys" id="backspace-key" title="Backspace" tabindex="14">
                      <i id="img-backspace-key" class="material-icons" style="font-size: 30px;margin-right: 2px">
                          backspace
                      </i>
                  </div>
                  <div id="equal-key" class="calc-key" style="font-size:41px;font-family:monospace" title="Equals (Calculate)" tabindex="13">
                      =
                  </div>
  
              </div>
          </div>
          `,e.appendChild(t.content.cloneNode(!0)),this.setOnclickForAllKeys(e),this.getOutputElement(e).focus()}connectedCallback(){console.log("'MyCalculator' custom element added to DOM!")}disconnectedCallback(){console.log("'MyCalculator' custom element 'REMOVED' from DOM!")}attributeChangedCallback(e,t,a){var i;console.log(`'${e}' attribute changed from '${t}' to '${a}' !`);let l=null===(i=this===null||void 0===this?void 0:this.shadowRoot)||void 0===i?void 0:i.querySelector(".calc-container"),r="width"===e||"height"===e||"margin"===e||"calc-name"===e||"calc-input"===e?e:"borderRadius",s=null==l?void 0:l.querySelector(".calc-heading > p");if("calc-name"===r&&(null==a?void 0:a.trim())!==""&&(null==s?void 0:s.textContent))s.textContent=a;else if("calc-input"===r&&/^[\d\.\+\-\x\/\^\!\(\)]+$/.test(a)){let c=null==l?void 0:l.querySelector("#output > input");if(!(null==c?void 0:c.value))return;c.value=a,c.focus()}else(null==l?void 0:l.style)&&(l.style[r]=a)}setOnclickForAllKeys(e){let t=e.querySelector("#output > input"),a=e.querySelectorAll(".calc-keys")[0],i,l,r=a=>{this.resetDisplay(e),this.insertChar(t,a),t.focus()},s=()=>{this.resetDisplay(e),t.value="",t.focus()},c=()=>{this.calculateResult(e,"**-1"),t.focus()},o=()=>{this.calculateResult(e,"**2"),t.focus()},n=()=>{this.calculateResult(e,"**0.5"),t.focus()},d=()=>{i=this.getDisplayTextBeforeCaret(t);let e=0,a=0,r=i.charAt(i.length-1);for(let s of i)e+="("===s?1:0,a+=")"===s?1:0;l=e===a?"(":"("===r||")"===r?r:/[\d\.\!]/.test(r)?")":"(",this.insertChar(t,l)},y=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"":/[\^\(]$/.test(i)?"":/[\-\+\x\/\.]$/.test(i)?this.replaceOperator(t,"^"):"^",this.insertChar(t,l)},p=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"":/[\(]$/.test(i)?"":/[\-\+\x\^\/\.]$/.test(i)?this.replaceOperator(t,"!"):"!",this.insertChar(t,l)},k=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"":/[\/\(]$/.test(i)?"":/[\-\+\x\^]$/.test(i)?this.replaceOperator(t,"/"):"/",this.insertChar(t,l)},u=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"":/[\x\(]$/.test(i)?"":/[\-\+\/\^]$/.test(i)?this.replaceOperator(t,"x"):"x",this.insertChar(t,l)},g=()=>{this.resetDisplay(e),i=this.getDisplayTextBeforeCaret(t),l=/[\-]$/.test(i)?"":/[\+\.]$/.test(i)?this.replaceOperator(t,"-"):"-",this.insertChar(t,l)},b=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"":/[\+\(]$/.test(i)?"":/[\-\.\x\/\^]$/.test(i)?this.replaceOperator(t,"+"):"+",this.insertChar(t,l)},h=()=>{this.resetDisplay(e);let a=this.getCaretPosition(t),i=t.value.split("");i.splice(--a,1),t.value=i.join(""),t.setSelectionRange(a,a),t.focus()},v=()=>{this.calculateResult(e,""),this.getOutputElement(e).focus()},x=()=>{this.resetDisplay(e),l=""===(i=this.getDisplayTextBeforeCaret(t))?"0.":/[\.]$/.test(i)?"":".",this.insertChar(t,l)};a.addEventListener("click",e=>{var t;switch(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.id){case"reset-key":s();break;case"inverse-key":case"img-inverse-key":c();break;case"squared-key":case"img-squared-key":o();break;case"sqrt-key":case"img-sqrt-key":n();break;case"parenthesis-key":d();break;case"exponent-key":case"img-exponent-key":y();break;case"factorial-key":p();break;case"divide-key":k();break;case"multiply-key":case"img-multiply-key":u();break;case"subtract-key":case"img-subtract-key":g();break;case"add-key":case"img-add-key":b();break;case"backspace-key":case"img-backspace-key":h();break;case"equal-key":v();break;case"decimal-point-key":x();break;case"key-0":r("0");break;case"key-1":r("1");break;case"key-2":r("2");break;case"key-3":r("3");break;case"key-4":r("4");break;case"key-5":r("5");break;case"key-6":r("6");break;case"key-7":r("7");break;case"key-8":r("8");break;case"key-9":r("9")}}),a.addEventListener("keydown",t=>{var a,i;if(null===(i=null===(a=null==t?void 0:t.target)||void 0===a?void 0:a.className)||void 0===i?void 0:i.includes("calc-key")){let l=t.target;(null==t?void 0:t.key)===" "&&(l.click(),setTimeout(()=>{"squared-key"!==l.id&&"img-squared-key"!==l.id&&(null==e?void 0:e.querySelector("#backspace-key")).click(),l.focus()},1))}}),t.addEventListener("focus",e=>{let a=this.getCaretPosition(t);t.setSelectionRange(a,a)}),t.addEventListener("keydown",a=>{let i=a.key;t.disabled=!/(\d|Backspace|Delete|Home|End|ArrowLeft|ArrowRight|Tab)/.test(i);let l="("===i||")"===i?"parenthesis-key":"!"===i?"factorial-key":"*"===i?"multiply-key":"Enter"===i?"equal-key":"="===i?"equal-key":"."===i?"decimal-point-key":"-"===i?"subtract-key":"+"===i?"add-key":"/"===i?"divide-key":"^"===i?"exponent-key":"Escape"===i?"reset-key":null;l&&(null==e?void 0:e.querySelector(`#${l}`)).click(),"Tab"!==i&&setTimeout(()=>{t.disabled=!1,t.focus()},10)})}insertChar(e,t){if("replaced"===t)return;if(""===t){e.focus();return}let a=this.getCaretPosition(e),i=e.value.split("");i.splice(a,0,t),e.value=i.join(""),a+=-1===a?2:1,a+="0."===t?1:0,e.setSelectionRange(a,a),e.focus()}getCaretPosition(e){return e?e.selectionStart||e.value.length-1:0}getDisplayTextBeforeCaret(e){let t=this.getCaretPosition(e);return e.value.substring(0,t)}replaceOperator(e,t){let a=this.getCaretPosition(e),i=e.value.split("");return i.splice(a-1,1,t),e.value=i.join(""),e.setSelectionRange(a,a),e.focus(),"replaced"}parseExpression(e){return e.replaceAll("x","*").replaceAll("^","**").replaceAll(".e","e").replaceAll(")(",")*(").replaceAll("0(","0*(").replaceAll("1(","1*(").replaceAll("2(","2*(").replaceAll("3(","3*(").replaceAll("4(","4*(").replaceAll("5(","5*(").replaceAll("6(","6*(").replaceAll("7(","7*(").replaceAll("8(","8*(").replaceAll("9(","9*(").replaceAll(".(","*(").replaceAll("!(","!*(").replaceAll(").",")*").replaceAll(")0",")*0").replaceAll(")1",")*1").replaceAll(")2",")*2").replaceAll(")3",")*3").replaceAll(")4",")*4").replaceAll(")5",")*5").replaceAll(")6",")*6").replaceAll(")7",")*7").replaceAll(")8",")*8").replaceAll(")9",")*9")}calculateResult(e,t){this.resetDisplay(e);let a=this.getOutputElement(e),i=a.value;if(""===i)return;i=this.parseExpression(i),i+=t;let l;try{if(/^!/.test(i))throw"Invalid Input";for(;/!/.test(i);)i=this.parseFactorialInput(i);if((l=Function("return "+i)())===1/0||l===-1/0)throw"Value too large";if(!0===l||!1===l)throw"Invalid Input";l.toString().length>14&&(l>1e14?l=l.toExponential(8):l>1?l=l.toPrecision(14):l<1&&(l=l.toExponential(8))),l=l.toString().replaceAll("e",".e"),a.value=l}catch(r){let s=this.getErrorMsgElement(e);a.style.color="rgb(255, 87, 21)",s.textContent="string"==typeof r?r:"Invalid Input"}}parseFactorialInput(e){let t=e.indexOf("!"),a=e.charAt(t+1),i=t-1,l=e.charAt(i),r=0,s=[];if(!/[\d\)]/.test(l))throw"Invalid Input";if(")"===l){let c="",o=i,n=0,d=1;for(;"("!==l||n!==d;){if(0===o)throw"Invalid Input";c+=e.charAt(o--),")"===(l=e.charAt(o))&&d++,"("===l&&n++}return c+="(",c=Function("return "+(c=c.split("").reverse().join("")))(),r=this.getFactorialOf(Number(c)),(s=e.split("")).splice(o,i-o+2,r.toString()),s.join("")}let y=0,p=0;for(;/\d/.test(l);)y+=parseInt(e.charAt(i),10)*10**p++,l=e.charAt(--i);if(/[\.]/.test(l))throw"Invalid Input";return r=this.getFactorialOf(y),s=e.split(""),/[\d\.\(]/.test(a)&&(r=r.toString()+"*"),s.splice(i+1,p+1,r.toString()),s.join("")}getFactorialOf(e){if(0===e)return 1;if(e<=2)return e;for(let t=e-1;t>=2;--t)if((e*=t)==1/0)throw"Value too large";return e}getOutputElement(e){return e.querySelector("#output > input")}getErrorMsgElement(e){return e.querySelector("#error-msg")}resetDisplay(e){let t=this.getOutputElement(e),a=this.getErrorMsgElement(e),i=a.textContent;("Invalid Input"===i||"Value too large"===i)&&(t.style.color="rgb(235, 235, 235)",a.textContent="")}});